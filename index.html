<html>
	<head>
		<style>

		  #card_overlay {
			position:relative;
			height: 6.35cm;
			width: 4.115cm;
		  }

		  #card_background {
			position:absolute;
			height: 6.35cm;
			width: 4.115cm;
		  }
		  
		  #card_image {
			position: absolute;
			max-height: 80%;
			max-width: 80%;
		  }
		 
		 .card_stats {
			position: absolute;
			font-family: EurostileLTStd;
			top:5.8cm;
		 }
		 
		 #output_range {
			right:3.2cm
		 }

		 #output_nb_dice {
			right:2.3cm
		 }
		 
		  #output_val_dice {
			right:1.4cm
		 }

		  #output_power {
			right:0.5cm
		 }
		 
		 #card_file {
			margin-top:10px
		 }
		 
		 .input_card_stats {
			width:24px;
		 }
		 
		 @font-face {
			font-family: EurostileLTStd;
			src: url("fonts/EurostileLTStd-BoldCn.otf") format("opentype");
			font-size: 42px;
			color:#000000;
			text-align:right;
		}

		  
		</style>

		<script src="libs/html2canvas.js"></script>
		<script>
		  function handleFileSelect(evt) {
			var files = evt.target.files; // FileList object

			// Loop through the FileList and render image files as thumbnails.
			for (var i = 0, f; f = files[i]; i++) {

			  // Only process image files.
			  if (!f.type.match('image.*')) {
				continue;
			  }

			  var reader = new FileReader();

			  // Closure to capture the file information.
			  reader.onload = (function(theFile) {
				return function(e) {
				  // Render thumbnail.
				  var card_image = document.getElementById("card_image");
				  card_image.src=e.target.result;
				  
				  card_image.style.left=(card_overlay.offsetWidth-card_image.offsetWidth)/2;
				  
				};
			  })(f);

			  
			  // Read in the image file as a data URL.
			  reader.readAsDataURL(f);
			}
			

		  }
		  
		  function convert(){
				html2canvas(document.getElementById("card_overlay"), {
				onrendered: function(canvas) {
					document.getElementById("card_download").href=canvas.toDataURL('image/png');
				},
				logging:true
			});
			
		  }
		  
		  function update(){
		  
			document.getElementById("card_background").src="blank_cards/0003.png";
			document.getElementById("output_range").innerHTML=document.getElementById("input_range").value;
			document.getElementById("output_nb_dice").innerHTML=document.getElementById("input_nb_dice").value;
			document.getElementById("output_val_dice").innerHTML=document.getElementById("input_val_dice").value;
			document.getElementById("output_power").innerHTML=document.getElementById("input_power").value;
			convert();
			
		  }

			window.onload = function(e){
				  var card_image = document.getElementById("card_image");
				  var card_overlay = document.getElementById("card_overlay");

				  document.getElementById('card_file').addEventListener('change', handleFileSelect, false);
				  document.getElementById('input_range').addEventListener('change', update, false);
				  document.getElementById('input_nb_dice').addEventListener('change', update, false);
				  document.getElementById('input_val_dice').addEventListener('change', update, false);
				  document.getElementById('input_power').addEventListener('change', update, false);
				  
				  update();
			  
			}
		  

		</script>	

	</head>
<body>

	<div id="card_overlay">
		<img src="" id="card_background"/>
		<img id="card_image" src=""/>
		<div id="output_range" class="card_stats"></div>
		<div id="output_nb_dice" class="card_stats"></div>
		<div id="output_val_dice" class="card_stats"></div>
		<div id="output_power" class="card_stats"></div>
	</div>

	<input type="file" id="card_file" name="files[]" multiple />
	<br/>
	<input id="input_range" type="text" class="input_card_stats" />
	<input id="input_nb_dice" type="text" class="input_card_stats" />
	<input id="input_val_dice" type="text" class="input_card_stats" >
	<input id="input_power" type="text" class="input_card_stats" />
	<a id="card_download" download="card.png" href="">Download</a>

<br/>
</body>
</html>